'use strict';

var _ava = require('ava');

var _ava2 = _interopRequireDefault(_ava);

var _request = require('request');

var _request2 = _interopRequireDefault(_request);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// test.cb() 回调函数形式测试异步代码，异步结束调用 t.end()
_ava2.default.cb('http api testing', function (t) {

    // 基于 Request API 创建 http 请求的配置
    var options = {
        baseUrl: 'https://api.github.com',
        url: '/users/Barrior',
        // 请求超时时间
        timeout: 5 * 1000,
        // http 请求头部，模拟得跟浏览器越像越好，不然被服务器处理成爬虫或者其他就可能得不到我们想要的响应
        headers: {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36'
        }
    };

    // Request API 发送 GET 请求
    _request2.default.get(options, function (err, res, body) {
        if (err) t.fail('服务器响应超时！');

        if (res && res.statusCode === 200) {
            body = JSON.parse(body);
            t.is(body.login, 'Barrior');
        } else {
            t.fail('无响应内容或状态码错误！');
        }

        // 异步结束
        t.end();
    });
});
//# sourceMappingURL=/data/wuqiaoqi/avatest/node_modules/.cache/ava/746d2d43d3d81df5ba7f5ada78c4beba.js.map